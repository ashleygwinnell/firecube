<HTML>
<HEAD>
<TITLE>
Mesh.h
</TITLE>
</HEAD>
<BODY>
<PRE>
<font color="blue">#ifndef</font> MESH_H
<font color="blue">#define</font> MESH_H

<font color="blue">#pragma</font> <font color="blue">warning</font><font color="black">(</font>push<font color="black">)</font>
<font color="blue">#pragma</font> <font color="blue">warning</font><font color="black">(</font>disable<font color="black">:</font><font color="maroon">4251</font><font color="black">)</font>

<font color="blue">#define</font> PRIMARY <font color="maroon">0x4d4d</font>
<font color="blue">#define</font> EDIT3DS <font color="maroon">0x3d3d</font>
<font color="blue">#define</font> KEYF3DS <font color="maroon">0xb000</font>

<font color="blue">#define</font> NAMED_OBJECT <font color="maroon">0x4000</font>
<font color="blue">#define</font> OBJ_MESH <font color="maroon">0x4100</font>
<font color="blue">#define</font> MESH_VERTICES <font color="maroon">0x4110</font>
<font color="blue">#define</font> MESH_FACES <font color="maroon">0x4120</font>
<font color="blue">#define</font> MESH_MATERIAL <font color="maroon">0x4130</font>
<font color="blue">#define</font> MESH_TEX_VERT <font color="maroon">0x4140</font>

<font color="blue">#define</font> MATERIAL <font color="maroon">0xafff</font>
<font color="blue">#define</font> MAT_NAME <font color="maroon">0xa000</font>
<font color="blue">#define</font> MAT_AMBIENT <font color="maroon">0xa010</font>
<font color="blue">#define</font> MAT_DIFFUSE <font color="maroon">0xa020</font>
<font color="blue">#define</font> MAT_SPECULAR <font color="maroon">0xa030</font>
<font color="blue">#define</font> MAT_SHININESS <font color="maroon">0xa040</font>
<font color="blue">#define</font> MAT_TEXMAP <font color="maroon">0xa200</font>
<font color="blue">#define</font> MAT_TEXFLNM <font color="maroon">0xa300</font>
<font color="blue">#define</font> MAT_SHIN2PCT <font color="maroon">0xa041</font>
<font color="blue">#define</font> MAT_SHIN3PCT <font color="maroon">0xa042</font>
<font color="blue">class</font> ModelResource;
<font color="blue">typedef</font> ResourceManager<font color="black">&#60;</font>ModelResource<font color="black">&#62;</font> ModelManager;
<font color="blue">typedef</font> boost<font color="black">:</font><font color="black">:</font>shared_ptr<font color="black">&#60;</font>ModelResource<font color="black">&#62;</font> Model;

<font color="green">/**
* Stores information about a material.
*/</font>
<font color="blue">class</font> FIRECUBE_API Material
<font color="black">{</font>
<font color="blue">public</font><font color="black">:</font>
    Material<font color="black">(</font><font color="black">)</font>;
    ~Material<font color="black">(</font><font color="black">)</font>;
    
    string <font color="blue">name</font>;
    vec3 ambient;
    vec3 diffuse;
    vec3 specular;
    <font color="blue">float</font> shininess;
    Texture tex;
<font color="black">}</font>;

<font color="green">/**
* Defines an edge in a mesh.
*/</font>
<font color="blue">class</font> FIRECUBE_API Edge
<font color="black">{</font>
<font color="blue">public</font><font color="black">:</font>
    DWORD v<font color="black">[</font><font color="maroon">2</font><font color="black">]</font>;
<font color="black">}</font>;
<font color="green">/**
* Defines a face in a mesh.
*/</font>
<font color="blue">class</font> FIRECUBE_API Face
<font color="black">{</font>
<font color="blue">public</font><font color="black">:</font>
    Face<font color="black">(</font><font color="black">)</font>;
    ~Face<font color="black">(</font><font color="black">)</font>;

    DWORD v<font color="black">[</font><font color="maroon">3</font><font color="black">]</font>;
    vec3 normal;
<font color="black">}</font>;
<font color="green">/**
* Stores a set of geometry sharing the same material.
*/</font>
<font color="blue">class</font> FIRECUBE_API Mesh
<font color="black">{</font>
<font color="blue">public</font><font color="black">:</font>
    Mesh<font color="black">(</font><font color="black">)</font>;
    ~Mesh<font color="black">(</font><font color="black">)</font>;
    
    Material <font color="black">*</font>material;
    vector<font color="black">&#60;</font>Face<font color="black">&#62;</font> face;
    Buffer indexBuffer;
<font color="black">}</font>;
<font color="green">/**
* A 3d object.&#60;br&#62;
* The object is composed of various meshes.
*/</font>
<font color="blue">class</font> FIRECUBE_API Object
<font color="black">{</font>
<font color="blue">public</font><font color="black">:</font>
    string <font color="blue">name</font>;
    vector<font color="black">&#60;</font>vec3<font color="black">&#62;</font> vertex;
    vector<font color="black">&#60;</font>vec3<font color="black">&#62;</font> normal;
    vector<font color="black">&#60;</font>Mesh<font color="black">&#62;</font> mesh;
    vector<font color="black">&#60;</font>Face<font color="black">&#62;</font> face;
    vector<font color="black">&#60;</font>vec2<font color="black">&#62;</font> uv;
    Buffer vertexBuffer;
    Buffer uvBuffer;
    Buffer normalBuffer;
<font color="black">}</font>;
<font color="green">/**
* A class representing a model resource.
*/</font>
<font color="blue">class</font> FIRECUBE_API ModelResource
<font color="black">{</font>
<font color="blue">public</font><font color="black">:</font>
    ModelResource<font color="black">(</font><font color="black">)</font>;
    ~ModelResource<font color="black">(</font><font color="black">)</font>;
    
    <font color="green">/**
    * Loads a 3ds file.
    * @param filename The file to load.
    */</font>
    <font color="blue">bool</font> Load<font color="black">(</font><font color="blue">const</font> string <font color="black">&</font>filename<font color="black">)</font>;
    DWORD ProcessChunk<font color="black">(</font><font color="blue">char</font> <font color="black">*</font>buffer<font color="black">)</font>;
    Material <font color="black">*</font>GetMaterialByName<font color="black">(</font><font color="blue">const</font> string <font color="black">&</font><font color="blue">name</font><font color="black">)</font>;
    <font color="green">/**
    * Reduces the model by removing duplicated vertices.
    * @return The reduced mesh.
    */</font>
    Model Reduce<font color="black">(</font><font color="black">)</font>; 
    <font color="green">/**
    * Calculates face and vertex normals.
    */</font>
    <font color="blue">void</font> CalculateNormals<font color="black">(</font><font color="black">)</font>;
    <font color="green">/**
    * Applies a transformation to the model vertices.
    * @param transform The transformation matrix.
    */</font>
    <font color="blue">void</font> ApplyTransformation<font color="black">(</font>mat4 <font color="black">&</font>transform<font color="black">)</font>;

    vector<font color="black">&#60;</font>Object<font color="black">&#62;</font> object;
    vector<font color="black">&#60;</font>Material<font color="black">&#62;</font> material;  
<font color="black">}</font>;

<font color="blue">#pragma</font> <font color="blue">warning</font><font color="black">(</font>pop<font color="black">)</font>

<font color="blue">#endif</font>
</PRE>
</BODY>
</HTML>
