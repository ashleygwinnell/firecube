<HTML>
<HEAD>
<TITLE>
Shaders.h
</TITLE>
</HEAD>
<BODY>
<PRE>
<font color="blue">#ifndef</font> SHADERS_H
<font color="blue">#define</font> SHADERS_H

<font color="blue">#pragma</font> <font color="blue">warning</font><font color="black">(</font>push<font color="black">)</font>
<font color="blue">#pragma</font> <font color="blue">warning</font><font color="black">(</font>disable<font color="black">:</font><font color="maroon">4251</font><font color="black">)</font>

<font color="blue">namespace</font> FireCube
<font color="black">{</font>
<font color="blue">class</font> ProgramResource;
<font color="blue">class</font> Program;
<font color="green">/* CPPDOC_BEGIN_EXCLUDE */</font>
<font color="blue">namespace</font> Renderer
<font color="black">{</font>
    <font color="blue">void</font> FIRECUBE_API UseProgram<font color="black">(</font>Program program<font color="black">)</font>;
    <font color="blue">void</font> FIRECUBE_API SetGlobalProgram<font color="black">(</font>Program program<font color="black">)</font>;
<font color="black">}</font>
<font color="green">/* CPPDOC_END_EXCLUDE */</font>

<font color="green">/** 
* Specifies the type of a shader.
*/</font>
<font color="blue">enum</font> ShaderType
<font color="black">{</font>
    VERTEX_SHADER,FRAGMENT_SHADER
<font color="black">}</font>;

<font color="blue">class</font> FIRECUBE_API ShaderResource
<font color="black">{</font>
    <font color="blue">friend</font> <font color="blue">class</font> ProgramResource;
<font color="blue">public</font><font color="black">:</font>
    ShaderResource<font color="black">(</font><font color="black">)</font>;
    ~ShaderResource<font color="black">(</font><font color="black">)</font>;  
    GLuint id;
<font color="black">}</font>;

<font color="green">/**
* A class Representing a single shader.
*/</font>
<font color="blue">class</font> FIRECUBE_API Shader
<font color="black">{</font>
    <font color="blue">friend</font> <font color="blue">class</font> ProgramResource;
    <font color="blue">friend</font> <font color="blue">class</font> ResourceManager<font color="black">&#60;</font>Shader,ShaderResource<font color="black">&#62;</font>;
<font color="blue">public</font><font color="black">:</font>
    Shader<font color="black">(</font><font color="black">)</font>;
    Shader<font color="black">(</font>boost<font color="black">:</font><font color="black">:</font>shared_ptr<font color="black">&#60;</font>ShaderResource<font color="black">&#62;</font> resource<font color="black">)</font>;
    <font color="green">/**
    * Loads a shader from a file. the shader type is determined by the extension of the file: .vert for a vertex shader, .frag for a fragment shader.
    * @param filename The file to load.
    */</font>
    <font color="blue">bool</font> Load<font color="black">(</font><font color="blue">const</font> std<font color="black">:</font><font color="black">:</font>string <font color="black">&</font>filename<font color="black">)</font>;
    <font color="green">/**
    * Creates a shader from source.
    * @param shaderType The type of the shader.
    * @param source The source of the shader.
    */</font>
    <font color="blue">bool</font> Create<font color="black">(</font>ShaderType type,<font color="blue">const</font> std<font color="black">:</font><font color="black">:</font>string <font color="black">&</font>source<font color="black">)</font>;
    <font color="green">/**
    * Returns the resource id of the shader.
    */</font>
    <font color="blue">unsigned</font> <font color="blue">int</font> GetId<font color="black">(</font><font color="black">)</font> <font color="blue">const</font>;

    <font color="blue">operator</font> <font color="blue">bool</font> <font color="black">(</font><font color="black">)</font> <font color="blue">const</font>;
    <font color="blue">bool</font> <font color="blue">operator</font><font color="black">=</font><font color="black">=</font> <font color="black">(</font><font color="blue">const</font> Shader <font color="black">&</font>shader<font color="black">)</font> <font color="blue">const</font>;
<font color="blue">private</font><font color="black">:</font>
    boost<font color="black">:</font><font color="black">:</font>shared_ptr<font color="black">&#60;</font>ShaderResource<font color="black">&#62;</font> resource;
<font color="black">}</font>;

<font color="blue">typedef</font> ResourceManager<font color="black">&#60;</font>Shader,ShaderResource<font color="black">&#62;</font> ShaderManager;

<font color="blue">class</font> FIRECUBE_API ProgramResource
<font color="black">{</font>
    <font color="blue">friend</font> <font color="blue">void</font> Renderer<font color="black">:</font><font color="black">:</font>UseProgram<font color="black">(</font>Program program<font color="black">)</font>;
    <font color="blue">friend</font> <font color="blue">void</font> Renderer<font color="black">:</font><font color="black">:</font>SetGlobalProgram<font color="black">(</font>Program program<font color="black">)</font>;
<font color="blue">public</font><font color="black">:</font>
    ProgramResource<font color="black">(</font><font color="black">)</font>;
    ~ProgramResource<font color="black">(</font><font color="black">)</font>;

    GLuint id;
    std<font color="black">:</font><font color="black">:</font>map<font color="black">&#60;</font>std<font color="black">:</font><font color="black">:</font>string,GLint<font color="black">&#62;</font> variables;
<font color="black">}</font>;

<font color="green">/**
* A class representing a gpu program.
*/</font>
<font color="blue">class</font> FIRECUBE_API Program
<font color="black">{</font>
    <font color="blue">friend</font> <font color="blue">void</font> Renderer<font color="black">:</font><font color="black">:</font>UseProgram<font color="black">(</font>Program program<font color="black">)</font>;
    <font color="blue">friend</font> <font color="blue">void</font> Renderer<font color="black">:</font><font color="black">:</font>SetGlobalProgram<font color="black">(</font>Program program<font color="black">)</font>;
<font color="blue">public</font><font color="black">:</font>
    <font color="green">/**
    * Creates the program.
    */</font>
    <font color="blue">void</font> Create<font color="black">(</font><font color="black">)</font>;
    <font color="green">/**
    * Creates the program and attaches two shaders to it.
    */</font>
    <font color="blue">void</font> Create<font color="black">(</font>Shader shader1,Shader shader2<font color="black">)</font>;
    <font color="green">/**
    * Attaches a shader to the program.
    * @param shader The shader to attach.
    */</font>
    <font color="blue">void</font> Attach<font color="black">(</font>Shader shader<font color="black">)</font>;
    <font color="green">/**
    * Links the program.
    */</font>
    <font color="blue">void</font> Link<font color="black">(</font><font color="black">)</font>;    
    <font color="green">/**
    * Sets a 1d uniform float.
    * @param name The name of the variable.
    * @param value The value to assign for it.
    */</font>
    <font color="blue">void</font> SetUniform<font color="black">(</font><font color="blue">const</font> std<font color="black">:</font><font color="black">:</font>string <font color="black">&</font><font color="blue">name</font>,<font color="blue">float</font> value<font color="black">)</font>;
    <font color="green">/**
    * Sets a 1d uniform integer.
    * @param name The name of the variable.
    * @param value The value to assign for it.
    */</font>
    <font color="blue">void</font> SetUniform<font color="black">(</font><font color="blue">const</font> std<font color="black">:</font><font color="black">:</font>string <font color="black">&</font><font color="blue">name</font>,<font color="blue">int</font> value<font color="black">)</font>;
    <font color="green">/**
    * Sets a 3d uniform float.
    * @param name The name of the variable.
    * @param value The value to assign for it.
    */</font>
    <font color="blue">void</font> SetUniform<font color="black">(</font><font color="blue">const</font> std<font color="black">:</font><font color="black">:</font>string <font color="black">&</font><font color="blue">name</font>,vec3 value<font color="black">)</font>;
    <font color="green">/**
    * Sets a 4d uniform float.
    * @param name The name of the variable.
    * @param value The value to assign for it.
    */</font>
    <font color="blue">void</font> SetUniform<font color="black">(</font><font color="blue">const</font> std<font color="black">:</font><font color="black">:</font>string <font color="black">&</font><font color="blue">name</font>,vec4 value<font color="black">)</font>;
    <font color="green">/**
    * Sets a 1d uniform boolean.
    * @param name The name of the variable.
    * @param value The value to assign for it.
    */</font>
    <font color="blue">void</font> SetUniform<font color="black">(</font><font color="blue">const</font> std<font color="black">:</font><font color="black">:</font>string <font color="black">&</font><font color="blue">name</font>,<font color="blue">bool</font> value<font color="black">)</font>;
    <font color="green">/**
    * Sets an array of booleans.
    * @param name The name of the variable.
    * @param value The value to assign for it.
    */</font>
    <font color="blue">void</font> SetUniform<font color="black">(</font><font color="blue">const</font> std<font color="black">:</font><font color="black">:</font>string <font color="black">&</font><font color="blue">name</font>,<font color="blue">const</font> std<font color="black">:</font><font color="black">:</font>vector<font color="black">&#60;</font><font color="blue">bool</font><font color="black">&#62;</font> <font color="black">&</font>value<font color="black">)</font>;
    <font color="green">/**
    * Sets an array of integers.
    * @param name The name of the variable.
    * @param value The value to assign for it.
    */</font>
    <font color="blue">void</font> SetUniform<font color="black">(</font><font color="blue">const</font> std<font color="black">:</font><font color="black">:</font>string <font color="black">&</font><font color="blue">name</font>,<font color="blue">const</font> std<font color="black">:</font><font color="black">:</font>vector<font color="black">&#60;</font><font color="blue">int</font><font color="black">&#62;</font> <font color="black">&</font>value<font color="black">)</font>;
    <font color="green">/**
    * Sets vertex shader attribute.
    * @param name The name of the variable.
    * @param buffer The buffer from which data will be read.
    */</font>
    <font color="blue">void</font> SetAttribute<font color="black">(</font><font color="blue">const</font> std<font color="black">:</font><font color="black">:</font>string <font color="black">&</font><font color="blue">name</font>,Buffer buffer,<font color="blue">int</font> size<font color="black">)</font>;
    <font color="green">/** 
    * @return Returns the compile log for this program.
    */</font>
    std<font color="black">:</font><font color="black">:</font>string GetInfoLog<font color="black">(</font><font color="black">)</font>;
    <font color="green">/**
    * Returns whether the program is valid.
    */</font>  
    <font color="blue">bool</font> IsValid<font color="black">(</font><font color="black">)</font> <font color="blue">const</font>;
    <font color="green">/**
    * Returns the resource id of the program.
    */</font>
    <font color="blue">unsigned</font> <font color="blue">int</font> GetId<font color="black">(</font><font color="black">)</font> <font color="blue">const</font>;

    <font color="blue">operator</font> <font color="blue">bool</font> <font color="black">(</font><font color="black">)</font> <font color="blue">const</font>;
    <font color="blue">bool</font> <font color="blue">operator</font><font color="black">=</font><font color="black">=</font> <font color="black">(</font><font color="blue">const</font> Program <font color="black">&</font>program<font color="black">)</font> <font color="blue">const</font>;

<font color="blue">private</font><font color="black">:</font>
    boost<font color="black">:</font><font color="black">:</font>shared_ptr<font color="black">&#60;</font>ProgramResource<font color="black">&#62;</font> resource;
<font color="black">}</font>;

<font color="blue">class</font> FIRECUBE_API TechniqueResource
<font color="black">{</font>
<font color="blue">public</font><font color="black">:</font>
    std<font color="black">:</font><font color="black">:</font>map<font color="black">&#60;</font><font color="blue">unsigned</font> <font color="blue">int</font>,Program<font color="black">&#62;</font> programs;
    std<font color="black">:</font><font color="black">:</font>string vertexShaderCode;
    std<font color="black">:</font><font color="black">:</font>string fragmentShaderCode;
<font color="black">}</font>;
<font color="blue">class</font> RenderState;
<font color="green">/**
* A class representing a technique.
*/</font>
<font color="blue">class</font> FIRECUBE_API Technique
<font color="black">{</font>   
<font color="blue">public</font><font color="black">:</font>
    <font color="green">/**
    * Creates the technique.
    */</font>
    <font color="blue">void</font> Create<font color="black">(</font><font color="black">)</font>;
    
    <font color="green">/**
    * Loads the specified shader.
    * @param filename The file name of the shader.
    * @return Returns true on success, false otherwise.
    */</font>
    <font color="blue">bool</font> LoadShader<font color="black">(</font><font color="blue">const</font> std<font color="black">:</font><font color="black">:</font>string <font color="black">&</font>filename<font color="black">)</font>;

    <font color="green">/**
    * Generates a program from a given render state.
    * @param renderState The render state to use to generate the program.
    */</font>
    Program GenerateProgram<font color="black">(</font><font color="blue">const</font> RenderState <font color="black">&</font>renderState<font color="black">)</font>;

    <font color="blue">operator</font> <font color="blue">bool</font> <font color="black">(</font><font color="black">)</font> <font color="blue">const</font>;
    <font color="blue">bool</font> <font color="blue">operator</font><font color="black">=</font><font color="black">=</font> <font color="black">(</font><font color="blue">const</font> Technique <font color="black">&</font>technique<font color="black">)</font> <font color="blue">const</font>;

<font color="blue">private</font><font color="black">:</font>
    boost<font color="black">:</font><font color="black">:</font>shared_ptr<font color="black">&#60;</font>TechniqueResource<font color="black">&#62;</font> resource;
<font color="black">}</font>;

<font color="black">}</font>
<font color="blue">#endif</font>
</PRE>
</BODY>
</HTML>
